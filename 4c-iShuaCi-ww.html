<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>介词填空练习</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f4;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .phrase {
            font-size: 24px;
            margin: 20px 0;
        }
        .result {
            font-size: 20px;
            margin: 10px 0;
        }
        .button-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        .button {
            padding: 15px;
            font-size: 18px;
            border: none;
            border-radius: 5px;
            background-color: #007bff;
            color: white;
            cursor: pointer;
        }
        .button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        .button.correct {
            background-color: green;
        }
        .button.incorrect {
            background-color: red;
        }
        .copyright {
            text-align: center;
            font-size: 12px;
            color: #ccc;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>介词填空练习</h1>       
        <div id="round-turn-label" class="round-turn">第 1 轮，第 1 回合</div>
        <p style="font-size: 12px; color: #888888;"> ·每 1 轮 - 共 5 个回合· </p>
        <div id="phrase-label" class="phrase"></div>
        <div id="result-label" class="result"></div>
        <div class="button-container" id="button-container">
            <!-- Buttons will be dynamically generated here -->
        </div>
        <div class="copyright">
            &copy; 2025 万碧君. 版权所有.
        </div>
    </div>

    <script>
        const phrases = [
            ["______ a hurry", "in"],
            ["______ a minute", "in"],
            ["______ addition", "in"],
            ["______ and over", "over"],
            ["______ average", "on"],
            ["______ breakfast / lunch / supper", "at"],
            ["______ business", "on"],
            ["______ class", "in"],
            ["______ danger", "in"],
            ["______ English", "in"],
            ["______ example", "for"],
            ["______ fact", "in"],
            ["______ first / last", "at"],
            ["______ foot", "on"],
            ["______ free", "for"],
            ["______ great care", "with"],
            ["______ holiday", "on"],
            ["______ hospital", "in"],
            ["______ least/ most", "at"],
            ["______ of date", "out"],
            ["______ once", "at"],
            ["______ one's fifties", "in"],
            ["______ one's joy/ surprise", "to"],
            ["______ one's opinion", "in"],
            ["______ other words", "in"],
            ["______ the past", "in"],
            ["______ pleasure", "with"],
            ["______ present", "at"],
            ["______ return", "in"],
            ["______ surprise", "in"],
            ["______ the end = at last", "in"],
            ["______ the end of July", "at"],
            ["______ the end of the road", "at"],
            ["______ the first time", "for"],
            ["______ the future", "in"],
            ["______ the help of", "with"],
            ["______ the other hand", "on"],
            ["______ the phone", "on"],
            ["______ phone", "by"],
            ["______ the same time", "at"],
            ["______ the time being", "for"],
            ["______ the/ one’s way (to)", "on"],
            ["______ trouble", "in"],
            ["______ weekdays", "on"],
            ["______ work", "at"],
            ["above ______", "all"],
            ["according ______", "to"],
            ["add…______…", "to"],
            ["after ______", "all"],
            ["agree ______ sb.", "with"],
            ["agree ______ do.", "to"],
            ["aim ______", "at"],
            ["all kinds ______", "of"],
            ["and so ______", "on"],
            ["apologize ______", "to"],
            ["apologize ______ sb. for sth.", "to"],
            ["apologize to sb. ______ sth.", "for"],
            ["arrive ______  the airport", "at"],
            ["as … ______", "as"],
            ["as soon ______", "as"],
            ["ask ______ a free ride", "for"],
            ["ask ______ leave", "for"],
            ["ask ______ help", "for"],
            ["be based ______", "on"],
            ["be afraid ______", "of"],
            ["be angry ______ sb．", "with"],
            ["be bad ______", "for"],
            ["be based ______", "on"],
            ["be busy ______ / doing sth．", "with"],
            ["be careful ______", "with"],
            ["be connected to/ ______", "with"],
            ["be covered ______", "with"],
            ["be different ______", "from"],
            ["be filled ______", "with"],
            ["be fond ______", "of"],
            ["be full ______", "of"],
            ["be good/ poor ______", "at"],
            ["be in charge ______", "of"],
            ["be interested ______", "in"],
            ["be keen ______", "on"],
            ["be late ______", "for"],
            ["be located (in/on/______)", "at"],
            ["be made ______ wood", "of"],
            ["be made up ______ ", "of"],
            ["be pleased ______", "with"],
            ["be proud ______", "of"],
            ["be ready ______", "for"],
            ["be responsible ______", "for"],
            ["be satisfied ______", "with"],
            ["be similar ______", "to"],
            ["be sorry ______", "for"],
            ["be strict ______", "with"],
            ["be surprised ______", "at"],
            ["be thankful ______ sb．", "to"],
            ["because ______", "of"],
            ["beg ______", "for"],
            ["belong ______", "to"],
            ["borrow sth. ______ sb.", "for"],
            ["lend sth. ______ sb.", "to"],
            ["pay ______ the bill", "for"],
            ["break ______ the house", "into"],
            ["by oneself =______ one's own", "on"],
            ["calm ______", "down"],
            ["care ______ = take care of", "for"],
            ["change ______", "into"],
            ["check ______ at the hotel", "in"],
            ["come ______ an end", "to"],
            ["come up ______ an idea", "with"],
            ["communicate ______", "with"],
            ["compare A and/______/to B", "with"],
            ["compete ______", "with"],
            ["complain ______/of sth.", "about"],
            ["consist ______", "of"],
            ["cut ______ the noise", "down"],
            ["deal ______", "with"],
            ["depend ______", "on"],
            ["die ______ hunger", "of"],
            ["do harm ______", "to"],
            ["be harmful ______", "to"],
            ["dream ______ doing", "of"],
            ["dress ______", "up"],
            ["eat in or take ______", "away"],
            ["enter ______", "for"],
            ["encourage sb. ______ do sth.", "to"],
            ["far away (______)", "from"],
            ["fill ______ the blanks", "in"],
            ["fill ______ the bottle with ink", "with"],
            ["fill the bottle ______", "with"],
            ["find ______ a secret", "out"],
            ["from time ______ time", "to"],
            ["get ______ difficulties", "over"],
            ["get ______ early", "up"],
            ["get ______ the habit of", "into"],
            ["get ______/off the bus", "on"],
            ["get along / on (______)", "with"],
            ["get ready ______", "for"],
            ["get rid ______", "of"],
            ["get tired ______", "of"],
            ["give ______ heat", "out"],
            ["go ______ a diet", "on"],
            ["go ______ a hard time", "through"],
            ["go ______ a picnic/ trip", "on"],
            ["go ______ a swim", "for"],
            ["go ______ bed", "to"],
            ["go ______ college", "to"],
            ["go ______ doing", "on"],
            ["go ______ for hiking", "in"],
            ["go ______ for sports", "in"],
            ["go ______ sleep", "to"],
            ["go ______ the cinema / movie(s)", "to"],
            ["go ______ (the)hospital", "to"],
            ["go ______ working", "on"],
            ["go ______ your work", "with"],
            ["grow ______", "up"],
            ["hand ______ your homework", "in"],
            ["happen ______ do sth.", "to"],
            ["happen ______ sb．", "to"],
            ["have pity ______ sb．", "on"],
            ["receive a letter/ hear ______ ", "from"],
            ["hear ______ her story", "of"],
            ["help sb. ______ sth．", "with"],
            ["help yourself ______", "to"],
            ["Hold ______, please!", "on"],
            ["hope ______ do", "to"],
            ["hope ______ the best", "for"],
            ["in charge ______ ", "of"],
            ["in favour ______", "of"],
            ["in front ______", "of"],
            ["in order ______", "to"],
            ["in the center ______", "of"],
            ["in the middle ______", "of"],
            ["jump ______ a conclusion", "to"],
            ["keep ______ the grass", "off"],
            ["keep ______ with others", "up"],
            ["keep in touch (______)", "with"],
            ["laugh ______ sb.", "at"],
            ["learn ______ others", "from"],
            ["leave ______ Beijing", "for"],
            ["less/ more ______", "than"],
            ["listen ______ music", "to"],
            ["live ______ bread", "on"],
            ["look ______ a new word", "up"],
            ["look ______ her cat", "after"],
            ["look ______ the board", "at"],
            ["look ______ the missing watch", "for"],
            ["look ______! = Be careful! ", "out"],
            ["look forward ______ doing", "to"],
            ["make ______ a story", "up"],
            ["make ______ one's mind", "up"],
            ["make friends ______", "with"],
            ["make fun ______", "of"],
            ["mean ______ ", "by"],
            ["next ______", "to"],
            ["one ______ another", "after"],
            ["operate ______ sb.", "on"],
            ["pay ______ the bill", "for"],
            ["pick ______ the rubbish", "up"],
            ["pick ______ your favourite one", "out"],
            ["play a trick ______", "on"],
            ["play ______ water", "with"],
            ["point ______ my mistake", "out"],
            ["prefer...______", "to"],
            ["prepare ______", "for"],
            ["prevent…______", "from"],
            ["protect...______", "from"],
            ["provide sb. ______ sth.", "with"],
            ["provide sth. ______ sb.", "for"],
            ["praise sb.  ______ sth.", "for"],
            ["put ______ = delay", "off"],
            ["put ______ a play ", "on"],
            ["put ______ fires", "out"],
            ["put ______ your hand/ a poster", "up"],
            ["refer ______", "to"],
            ["rely ______", "on"],
            ["run ______ of", "out"],
            ["search ______", "for"],
            ["see sb. ______", "off"],
            ["sell ______", "out"],
            ["shake hands ______", "with"],
            ["share … ______", "with"],
            ["show ______ his strength", "off"],
            ["show sb. ______ spl.", "around"],
            ["smile______", "at"],
            ["shut ______", "up"],
            ["spend ______", "on"],
            ["stand ______", "for"],
            ["stay ______ late", "up"],
            ["stop … ______", "from"],
            ["such ______", "as"],
            ["succeed ______", "in"],
            ["take a message ______ sb.", "for"],
            ["take care ______", "of"],
            ["take charge ______", "of"],
            ["take hold ______", "of"],
            ["take part ______", "in"],
            ["take the place ______", "of"],
            ["take ______ fishing", "up"],
            ["talk ______ the news", "about"],
            ["talk ______ / with sb", "to"],
            ["tell A ______ B", "from"],
            ["the same + n.+ ______", "as"],
            ["throw ______ the rubbish", "away"],
            ["too … ______", "to"],
            ["take a day ______", "off"],
            ["It turned ______ that", "out"],
            ["turn ______ ice", "into"],
            ["turn ______ the fish", "over"],
            ["turn ______ to be true", "out"],
            ["turn ______ /down the radio", "up"],
            ["turn up/______ the radio", "down"],
            ["turn on/______ the light", "off"],
            ["wait ______ me", "for"],
            ["wake ______", "up"],
            [" ______ one's own eyes", "with"],
            ["work ______ =solve", "out"],
            ["worry ______", "about"],
            ["would like / love (______)", "to"]
]
        const prepositions = [
            "about", "after", "against", "around", "as", "at", 
            "away", "by", "down", "for", "from", "in", "into", 
            "like", "of", "off", "on", "out", "over", "than", 
            "to", "up", "with", "through"
        ];

        let currentPhraseIndex = 0;
        let correctCount = 0;
        let currentPhrases = [];
        let score = 0;
        let roundNumber = 0;
        let turnNumber = 1;
        const totalRounds = 5;
        let startTime = 0;
        let totalTime = 0;
        let totalScore = 0;
        let totalTimeAllRounds = 0;
        let highestScore = 0;
        let bestTime = 0;
        let currentOptions = [];

        const roundTurnLabel = document.getElementById('round-turn-label');
        const phraseLabel = document.getElementById('phrase-label');
        const resultLabel = document.getElementById('result-label');
        const buttonContainer = document.getElementById('button-container');

        function updateInterface() {
            if (currentPhraseIndex < currentPhrases.length) {
                const [phrase, correctPrep] = currentPhrases[currentPhraseIndex];
                phraseLabel.textContent = phrase;
                resultLabel.textContent = '';
                startTime = Date.now();

                const wrongPreps = prepositions.filter(p => p !== correctPrep);
                const selectedWrongPreps = wrongPreps.sort(() => 0.5 - Math.random()).slice(0, 8);
                currentOptions = [...selectedWrongPreps, correctPrep].sort(() => 0.5 - Math.random());

                buttonContainer.innerHTML = '';
                currentOptions.forEach(prep => {
                    const button = document.createElement('button');
                    button.textContent = prep;
                    button.className = 'button';
                    button.addEventListener('click', () => onButtonClick(prep));
                    buttonContainer.appendChild(button);
                });

                setTimeout(checkTimeout, 5000);
            } else {
                endTurn();
            }
        }

        function onButtonClick(prep) {
            if (currentPhraseIndex < currentPhrases.length) {
                const [phrase, correctPrep] = currentPhrases[currentPhraseIndex];
                const elapsedTime = (Date.now() - startTime) / 1000;
                totalTime += elapsedTime;
        
                if (prep === correctPrep) {
                    resultLabel.textContent = '✓ 正确！';
                    resultLabel.style.color = 'green';
                    correctCount++;
                    score++;
                    currentPhrases[currentPhraseIndex][2] = true; // 更新 isCorrect 为 true
                } else {
                    resultLabel.textContent = `❌ 错误！正确答案是: ${correctPrep}`;
                    resultLabel.style.color = 'red';
                    currentPhrases[currentPhraseIndex][2] = false; // 更新 isCorrect 为 false
                }
        
                disableButtons();
                currentPhraseIndex++;
                setTimeout(updateInterface, 1000);
            }
        }

        function checkTimeout() {
            if (currentPhraseIndex < currentPhrases.length) {
                const [phrase, correctPrep] = currentPhrases[currentPhraseIndex];
                const elapsedTime = (Date.now() - startTime) / 1000;
                totalTime += elapsedTime;

                if (elapsedTime >= 5) {
                    resultLabel.textContent = `❌  超时！正确答案是: ${correctPrep}`;
                    resultLabel.style.color = 'red';
                    currentPhraseIndex++;
                    disableButtons();
                    setTimeout(updateInterface, 1000);
                }
            }
        }

        function disableButtons() {
            const buttons = document.querySelectorAll('.button');
            buttons.forEach(button => button.disabled = true);
        }

        function endTurn() {
            totalScore += score;
            totalTimeAllRounds += totalTime;

            const turnSummary = currentPhrases.map(([p, prep, isCorrect]) => 
                `${isCorrect ? '' : '✦'} ${p.replace('______', prep)}`
            ).join('\n');

            alert(
                `第 ${turnNumber} 回合结束\n` +
                `本轮得分：${score}\n本轮用时：${Math.floor(totalTime)} 秒\n\n` +
                `当前回合词组：\n${turnSummary}`
            );

            if (turnNumber < 5) {
                turnNumber++;
                currentPhraseIndex = 0;
                correctCount = 0;
                score = 0;
                totalTime = 0;
                currentPhrases = phrases.sort(() => 0.5 - Math.random()).slice(0, 5);
                roundTurnLabel.textContent = `第 ${roundNumber} 轮，第 ${turnNumber} 回合`;
                updateInterface();
            } else {
                endRound();
            }
        }

        function endRound() {
            if (totalScore > highestScore) {
                highestScore = totalScore;
                bestTime = totalTimeAllRounds;
            }

            alert(
                `第 ${roundNumber} 轮结束\n` +
                `本轮总得分：${totalScore}\n本轮总用时：${Math.floor(totalTimeAllRounds)} 秒\n\n` +
                `历史最高分：${highestScore}（总用时：${Math.floor(bestTime)} 秒）`
            );

            if (confirm('是否开始下一轮？')) {
                resetRound();
            } else {
                // 结束游戏
            }
        }

        function resetRound() {
            roundNumber++;
            turnNumber = 1;
            totalScore = 0;
            totalTimeAllRounds = 0;
            currentPhraseIndex = 0;
            correctCount = 0;
            score = 0;
            totalTime = 0;
          	usedPhrases.clear(); // 清空已使用的词组集合
            selectUniquePhrases();
            roundTurnLabel.textContent = `第 ${roundNumber} 轮，第 ${turnNumber} 回合`;
            updateInterface();
        }

        const usedPhrases = new Set();
        function selectUniquePhrases() {
            currentPhrases = [];
            const availablePhrases = phrases.filter(([phrase]) => !usedPhrases.has(phrase));
    
            while (currentPhrases.length < 5 && availablePhrases.length > 0) {
                const randomIndex = Math.floor(Math.random() * availablePhrases.length);
                const selectedPhrase = availablePhrases.splice(randomIndex, 1)[0];
                usedPhrases.add(selectedPhrase[0]);
                currentPhrases.push([...selectedPhrase]);
            }
        }

        resetRound();
    </script>
</body>
</html
